<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css"
    integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">

  <link rel="stylesheet" href="https://bootswatch.com/4/darkly/bootstrap.min.css" />

  <link rel="stylesheet" href="/css/style2.css" type="text/css" />
</head>

<header>
  <div>
    <h4>SFU Online</h4>
    <nav>
      <ul>
        <li><a href="/users/logout">Logout</a></li>
        <li><a href="/users/message">Messaging</a></li>
        <li><a href="/room">Video Room</a></li>
        <li><a href="/users/channel">Group Channel</a></li>
      </ul>
    </nav>
  </div>
</header>

<style>
body {
  margin: 0px;
}

.container {
  width: 80%;
  margin: 0 auto;
}

header {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  background: #444444;
}

h4 {
  margin-left: 30px;
  margin-top: 20px;
  margin-bottom: 20px;
  display: flex;
  float: left;
}

nav {
  margin-right: 30px;
  /* margin-top: 20px; */
  margin-bottom: 20px;
  float: right;
}

nav ul {
  margin: 0;
  padding: 0;
  list-style: none;
}

nav li {
  display: inline-block;
  margin-left: 50px;
  padding-top: 20px;
  position: relative;
}

nav ul > li > a {
  color: #9a9999;
  text-decoration: none;
}

nav a:hover {
  color: #fff;
  text-decoration: none;
}

nav a::before {
  content: '';
  display: block;
  height: 2px;
  background-color: #fff;
  position: absolute;
  top: 0;
  width: 0%;
  transition: all ease-in-out 150ms;
}

nav a:hover::before {
  width: 100%;
}

.division {
  margin-top: 90px;
  margin-left: 200px;
  margin-right: 200px;
}

</style>



<body>

<div class="division">

  <a href="https://sfu-online.herokuapp.com/users/channel_page/<%=name%>" > Back</a>


  <div>
      <h1>New message</h1>
      <div>
        <input id='sender' type="text" name="sender" class="form-control" placeholder="Name" required>
      </div>
      <div>
        <input id='message' type="text" name="message" class="form-control" placeholder="Enter a message" required>
      </div>
      <input id='msgCreate' type="submit" class="btn btn-primary btn-block" value="Submit">
  </div>


<div>

  <script>
    const btnCreate = document.getElementById("msgCreate")
    msgCreate.addEventListener("click", async e => {
      let jsonRequest = {}
      jsonRequest.sender = document.getElementById("sender").value
      jsonRequest.message = document.getElementById("message").value
      console.log("clientside:" + jsonRequest.sender);
      console.log("clientside:" + JSON.stringify(jsonRequest));
      let result = await fetch("https://sfu-online.herokuapp.com/users/channel_page/<%=name%>", {
        method: "POST",
        headers: { "content-type": "application/json" }, body: JSON.stringify(jsonRequest)
      })
    })

    // redirects to channel_page
    document.getElementById("msgCreate").onclick = function () {
      location.assign("https://sfu-online.herokuapp.com/users/channel_page/<%=name%>");
    }

  </script>

</div>
</div>

</body>
